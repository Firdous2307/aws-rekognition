# Automate Image Upload to S3 with Lambda, EventBridge, and CloudWatch

## Introduction

Automating the image upload process to Amazon S3 with AWS Lambda, EventBridge, and CloudWatch not only streamlines the workflow but also opens up opportunities for advanced image processing.

In this section, I will be exploring how you can use the images stored in my S3 bucket for detection through Amazon Rekognition, specifically focusing on Rekognition Custom Labels.

## Prerequisites

Ensure you have the following in place:

- AWS account with necessary permissions.
- Terraform installed locally.


## Workflow Overview

1. **Manual Image Upload:**
   - Users manually upload images to an S3 bucket(any desired naming of your choice).

2. **S3 Event Trigger:**
   - Configure S3 bucket to generate events for `PutObject` actions.

3. **Lambda Function:**
   - Set up a Lambda function to process uploaded images.
   - Grant Lambda necessary IAM permissions for S3 access.

4. **EventBridge Rule:**
   - Create an EventBridge rule to trigger Lambda on S3 events.
   - Customize the rule to match `PutObject` events.

5. **CloudWatch Logging:**
   - Configure CloudWatch Logs for Lambda function.
   - Set up CloudWatch Metric Alarms for monitoring.


## My Process

So this is about automating image upload. I intend to get some very images and upload it to my S3 Bucket.

Then, I will create a Lambda Function code to read and upload those images,then an EventBridge rule to trigger the lambda function on S3 Events.

Monitor this process with CloudWatch


## Amazon Rekognition Custom Labels Integration

1. **Rekognition Setup:**
   - Ensure you have the Amazon Rekognition service and specifically **Rekognition Custom Labels** enabled in your AWS account.

2. **Custom Labels Project:**
   - Create a Rekognition Custom Labels project in the AWS Management Console.
   - Choose "Image" as the project type.

3. **S3 Bucket for Custom Labels:**
   - If you already have an existing S3 bucket with images, select the option to use your existing bucket.
   - If not, create a new bucket or select an existing bucket to store training data and results.

4. **Labeling Your Images:**
   - Label images in your S3 bucket for training. This is a crucial step for Rekognition Custom Labels to learn and identify specific objects.

5. **Lambda-Amazon Rekognition Custom Labels Integration:**
   - Enhance your existing Lambda function to integrate with Amazon Rekognition Custom Labels.
   - Use the AWS SDK to call Rekognition Custom Labels APIs for image analysis.


## Terraform Configuration

### S3 Module

```hcl
# modules/s3/main.tf

provider "aws" {
  region = var.region
}

resource "aws_s3_bucket" "this" {
  bucket = var.bucket_name

  versioning {
    enabled = true
  }
}

output "bucket_name" {
  value = aws_s3_bucket.this.bucket
}


